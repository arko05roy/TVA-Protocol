{"version":3,"sources":["../src/provider.ts","../src/signer.ts"],"names":[],"mappings":"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","file":"index.mjs","sourcesContent":["/**\n * TVA Protocol ethers.js Provider\n *\n * A custom JsonRpcProvider that connects to the TVA RPC server,\n * enabling standard ethers.js patterns to work with Stellar/Soroban.\n */\n\nimport {\n  JsonRpcProvider,\n  Network,\n  Block,\n  TransactionReceipt,\n  type BlockTag,\n  type TransactionRequest,\n} from 'ethers';\nimport {\n  NETWORKS,\n  TVA_CHAIN_ID,\n  type NetworkType,\n} from '@tva-protocol/sdk';\n\n/**\n * TVA Network configuration for ethers.js\n */\nexport const TVA_NETWORK = new Network('TVA Protocol', TVA_CHAIN_ID);\n\n/**\n * TVA Provider Options\n */\nexport interface TVAProviderOptions {\n  /** Network type or custom RPC URL */\n  network?: NetworkType | string;\n  /** Polling interval in milliseconds (default: 5000 for Stellar's ~5s blocks) */\n  pollingInterval?: number;\n  /** Static network to skip network detection */\n  staticNetwork?: boolean;\n}\n\n/**\n * TVA JSON-RPC Provider\n *\n * Extends ethers.js JsonRpcProvider to work with TVA Protocol's RPC layer.\n * Handles TVA-specific quirks while maintaining full ethers.js compatibility.\n */\nexport class TVAProvider extends JsonRpcProvider {\n  private readonly tvaNetwork: NetworkType;\n\n  constructor(options: TVAProviderOptions = {}) {\n    const networkType = typeof options.network === 'string' && options.network.startsWith('http')\n      ? 'testnet'\n      : (options.network as NetworkType) || 'testnet';\n\n    const rpcUrl = typeof options.network === 'string' && options.network.startsWith('http')\n      ? options.network\n      : NETWORKS[networkType].rpcUrl;\n\n    // Create the TVA network\n    const network = new Network('TVA Protocol', TVA_CHAIN_ID);\n\n    super(rpcUrl, network, {\n      staticNetwork: options.staticNetwork !== false ? network : undefined,\n      polling: true,\n      pollingInterval: options.pollingInterval || 5000,\n    });\n\n    this.tvaNetwork = networkType;\n  }\n\n  /**\n   * Gets the TVA network type\n   */\n  getTVANetwork(): NetworkType {\n    return this.tvaNetwork;\n  }\n\n  /**\n   * Gets the Stellar/Soroban RPC URL for direct access if needed\n   */\n  getSorobanRpcUrl(): string {\n    return NETWORKS[this.tvaNetwork].sorobanRpcUrl;\n  }\n\n  /**\n   * Override to handle TVA-specific block formatting\n   */\n  async getBlock(\n    blockHashOrBlockTag: BlockTag | string,\n    prefetchTxs?: boolean\n  ): Promise<Block | null> {\n    const block = await super.getBlock(blockHashOrBlockTag, prefetchTxs);\n\n    if (!block) {\n      return null;\n    }\n\n    return block;\n  }\n\n  /**\n   * Override to handle TVA-specific transaction receipt formatting\n   */\n  async getTransactionReceipt(hash: string): Promise<TransactionReceipt | null> {\n    const receipt = await super.getTransactionReceipt(hash);\n    return receipt;\n  }\n\n  /**\n   * Override to handle TVA-specific gas estimation\n   * TVA converts Soroban resources to gas units\n   */\n  async estimateGas(tx: TransactionRequest): Promise<bigint> {\n    const gas = await super.estimateGas(tx);\n    // TVA RPC already returns gas in EVM-compatible units\n    return gas;\n  }\n\n  /**\n   * Gets the native XLM balance of an address\n   * Note: Returns balance in wei-equivalent (18 decimals) for ethers.js compatibility\n   */\n  async getXlmBalance(address: string): Promise<bigint> {\n    return this.getBalance(address);\n  }\n\n  /**\n   * Waits for a transaction to be included in a block\n   * Override to use TVA's faster block times (~5 seconds)\n   */\n  async waitForTransaction(\n    hash: string,\n    _confirms?: number,\n    timeout?: number\n  ): Promise<TransactionReceipt | null> {\n    const timeoutMs = timeout || 60000;\n    const startTime = Date.now();\n\n    while (Date.now() - startTime < timeoutMs) {\n      const receipt = await this.getTransactionReceipt(hash);\n      if (receipt) {\n        return receipt;\n      }\n      // Wait 2 seconds between polls (Stellar has ~5s block time)\n      await new Promise((resolve) => setTimeout(resolve, 2000));\n    }\n\n    return null;\n  }\n\n  /**\n   * Checks if the provider is connected to the TVA RPC\n   */\n  async isConnected(): Promise<boolean> {\n    try {\n      await this.getBlockNumber();\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Gets TVA-specific network information\n   */\n  async getTVANetworkInfo(): Promise<{\n    chainId: number;\n    networkType: NetworkType;\n    blockNumber: number;\n    gasPrice: bigint;\n  }> {\n    const [chainId, blockNumber, gasPrice] = await Promise.all([\n      this.send('eth_chainId', []),\n      this.getBlockNumber(),\n      this.getFeeData(),\n    ]);\n\n    return {\n      chainId: parseInt(chainId, 16),\n      networkType: this.tvaNetwork,\n      blockNumber,\n      gasPrice: gasPrice.gasPrice || BigInt(0),\n    };\n  }\n}\n\n/**\n * Creates a TVA provider for the specified network\n */\nexport function createTVAProvider(\n  networkOrUrl: NetworkType | string = 'testnet',\n  options: Omit<TVAProviderOptions, 'network'> = {}\n): TVAProvider {\n  return new TVAProvider({\n    ...options,\n    network: networkOrUrl,\n  });\n}\n\n/**\n * Connects to the default TVA testnet\n */\nexport function getDefaultProvider(): TVAProvider {\n  return createTVAProvider('testnet');\n}\n","/**\n * TVA Protocol ethers.js Signer\n *\n * Custom signer that handles TVA's dual-key architecture (EVM + Stellar)\n * while providing a standard ethers.js Signer interface.\n */\n\nimport {\n  AbstractSigner,\n  TransactionRequest,\n  TransactionResponse,\n  TypedDataDomain,\n  TypedDataField,\n  Transaction,\n  resolveAddress,\n  type SigningKey,\n  type TransactionLike,\n} from 'ethers';\nimport { Wallet } from 'ethers';\nimport type { TVAProvider } from './provider.js';\n\n/**\n * TVA Signer Options\n */\nexport interface TVASignerOptions {\n  /** EVM private key (hex string with or without 0x prefix) */\n  privateKey: string;\n  /** Optional Stellar secret key for direct Stellar operations */\n  stellarSecretKey?: string;\n}\n\n/**\n * TVA Signer\n *\n * Extends ethers.js signing capabilities for TVA Protocol.\n * Uses the EVM private key for transaction signing while maintaining\n * compatibility with TVA's RPC translation layer.\n */\nexport class TVASigner extends AbstractSigner<TVAProvider> {\n  private readonly evmWallet: Wallet;\n  private readonly stellarSecretKey?: string;\n\n  constructor(options: TVASignerOptions, provider?: TVAProvider) {\n    super(provider);\n\n    // Normalize private key\n    const privateKey = options.privateKey.startsWith('0x')\n      ? options.privateKey\n      : `0x${options.privateKey}`;\n\n    // Create underlying ethers wallet for EVM signing\n    this.evmWallet = new Wallet(privateKey);\n    this.stellarSecretKey = options.stellarSecretKey;\n  }\n\n  /**\n   * Gets the EVM address of this signer\n   */\n  async getAddress(): Promise<string> {\n    return this.evmWallet.address;\n  }\n\n  /**\n   * Connects this signer to a provider\n   */\n  connect(provider: TVAProvider): TVASigner {\n    return new TVASigner(\n      {\n        privateKey: this.evmWallet.privateKey,\n        stellarSecretKey: this.stellarSecretKey,\n      },\n      provider\n    );\n  }\n\n  /**\n   * Signs a message using the EVM private key\n   */\n  async signMessage(message: string | Uint8Array): Promise<string> {\n    return this.evmWallet.signMessage(message);\n  }\n\n  /**\n   * Signs typed data (EIP-712)\n   */\n  async signTypedData(\n    domain: TypedDataDomain,\n    types: Record<string, TypedDataField[]>,\n    value: Record<string, unknown>\n  ): Promise<string> {\n    return this.evmWallet.signTypedData(domain, types, value);\n  }\n\n  /**\n   * Signs a transaction\n   */\n  async signTransaction(tx: TransactionRequest): Promise<string> {\n    // Build transaction-like object with resolved values\n    const txLike: TransactionLike = {\n      type: tx.type ?? 0,\n      chainId: tx.chainId ?? undefined,\n      nonce: tx.nonce ?? undefined,\n      gasLimit: tx.gasLimit ?? undefined,\n      gasPrice: tx.gasPrice ?? undefined,\n      maxFeePerGas: tx.maxFeePerGas ?? undefined,\n      maxPriorityFeePerGas: tx.maxPriorityFeePerGas ?? undefined,\n      to: tx.to ? await resolveAddress(tx.to, this.provider) : null,\n      value: tx.value ?? 0n,\n      data: tx.data ?? '0x',\n      accessList: tx.accessList ?? undefined,\n    };\n\n    // Get chain ID from provider if not specified\n    if (txLike.chainId === undefined && this.provider) {\n      const network = await this.provider.getNetwork();\n      txLike.chainId = network.chainId;\n    }\n\n    // Get nonce if not specified\n    if (txLike.nonce === undefined && this.provider) {\n      txLike.nonce = await this.provider.getTransactionCount(\n        await this.getAddress()\n      );\n    }\n\n    // Get gas price if not specified\n    if (!txLike.gasPrice && !txLike.maxFeePerGas && this.provider) {\n      const feeData = await this.provider.getFeeData();\n      if (feeData.gasPrice) {\n        txLike.gasPrice = feeData.gasPrice;\n      }\n    }\n\n    // Estimate gas if not specified\n    if (!txLike.gasLimit && this.provider) {\n      txLike.gasLimit = await this.provider.estimateGas({\n        from: await this.getAddress(),\n        to: txLike.to ?? undefined,\n        data: txLike.data,\n        value: txLike.value,\n      });\n    }\n\n    // Create and sign transaction\n    const transaction = Transaction.from(txLike);\n    const signature = this.evmWallet.signingKey.sign(transaction.unsignedHash);\n    transaction.signature = signature;\n\n    return transaction.serialized;\n  }\n\n  /**\n   * Sends a transaction\n   */\n  async sendTransaction(tx: TransactionRequest): Promise<TransactionResponse> {\n    if (!this.provider) {\n      throw new Error('No provider connected');\n    }\n\n    // Sign the transaction (this populates missing fields)\n    const signedTx = await this.signTransaction(tx);\n\n    // Broadcast via provider\n    return this.provider.broadcastTransaction(signedTx);\n  }\n\n  /**\n   * Gets the Stellar secret key if available\n   */\n  getStellarSecretKey(): string | undefined {\n    return this.stellarSecretKey;\n  }\n\n  /**\n   * Gets the underlying signing key\n   */\n  get signingKey(): SigningKey {\n    return this.evmWallet.signingKey;\n  }\n}\n\n/**\n * Creates a TVA signer from a private key\n */\nexport function createTVASigner(\n  privateKey: string,\n  provider?: TVAProvider\n): TVASigner {\n  return new TVASigner({ privateKey }, provider);\n}\n\n/**\n * Creates a TVA signer with both EVM and Stellar keys\n */\nexport function createDualKeySigner(\n  evmPrivateKey: string,\n  stellarSecretKey: string,\n  provider?: TVAProvider\n): TVASigner {\n  return new TVASigner(\n    {\n      privateKey: evmPrivateKey,\n      stellarSecretKey,\n    },\n    provider\n  );\n}\n"]}