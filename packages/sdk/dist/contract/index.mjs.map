{"version":3,"sources":["../../src/types/index.ts","../../src/contract/contract.ts"],"names":[],"mappings":"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","file":"index.mjs","sourcesContent":["/**\n * TVA Protocol Type Definitions\n *\n * These types define the core abstractions for the TVA Protocol,\n * bridging EVM and Stellar/Soroban concepts.\n */\n\n// ============================================================================\n// Network Configuration\n// ============================================================================\n\nexport type NetworkType = 'testnet' | 'mainnet' | 'local';\n\nexport interface NetworkConfig {\n  /** Network identifier */\n  type: NetworkType;\n  /** TVA RPC endpoint URL */\n  rpcUrl: string;\n  /** Stellar Horizon URL */\n  horizonUrl: string;\n  /** Stellar Soroban RPC URL */\n  sorobanRpcUrl: string;\n  /** Network passphrase for Stellar */\n  networkPassphrase: string;\n  /** Chain ID for EVM compatibility */\n  chainId: number;\n  /** Native currency symbol (XLM) */\n  nativeCurrency: {\n    name: string;\n    symbol: string;\n    decimals: number;\n  };\n}\n\n/**\n * TVA Chain ID: \"TVA\\0\" = 0x54564100 = 1414676736\n */\nexport const TVA_CHAIN_ID = 1414676736;\n\nexport const NETWORKS: Record<NetworkType, NetworkConfig> = {\n  testnet: {\n    type: 'testnet',\n    rpcUrl: 'http://localhost:8545', // TVA RPC server\n    horizonUrl: 'https://horizon-testnet.stellar.org',\n    sorobanRpcUrl: 'https://soroban-testnet.stellar.org',\n    networkPassphrase: 'Test SDF Network ; September 2015',\n    chainId: TVA_CHAIN_ID,\n    nativeCurrency: {\n      name: 'Stellar Lumens',\n      symbol: 'XLM',\n      decimals: 7,\n    },\n  },\n  mainnet: {\n    type: 'mainnet',\n    rpcUrl: 'http://localhost:8545', // TVA RPC server (production URL TBD)\n    horizonUrl: 'https://horizon.stellar.org',\n    sorobanRpcUrl: 'https://soroban.stellar.org',\n    networkPassphrase: 'Public Global Stellar Network ; September 2015',\n    chainId: TVA_CHAIN_ID,\n    nativeCurrency: {\n      name: 'Stellar Lumens',\n      symbol: 'XLM',\n      decimals: 7,\n    },\n  },\n  local: {\n    type: 'local',\n    rpcUrl: 'http://localhost:8545',\n    horizonUrl: 'http://localhost:8000',\n    sorobanRpcUrl: 'http://localhost:8001',\n    networkPassphrase: 'Standalone Network ; February 2017',\n    chainId: TVA_CHAIN_ID,\n    nativeCurrency: {\n      name: 'Stellar Lumens',\n      symbol: 'XLM',\n      decimals: 7,\n    },\n  },\n};\n\n// ============================================================================\n// Address Types\n// ============================================================================\n\n/** 20-byte EVM-compatible address (hex string with 0x prefix) */\nexport type EvmAddress = `0x${string}`;\n\n/** 56-character Stellar G-address (Ed25519 public key) */\nexport type StellarAddress = `G${string}`;\n\n/** Soroban contract ID (C-address, 56 characters) */\nexport type SorobanContractId = `C${string}`;\n\n/** Generic address that could be EVM or Stellar format */\nexport type Address = EvmAddress | StellarAddress | SorobanContractId;\n\n/** Mapping between EVM and Stellar addresses */\nexport interface AddressMapping {\n  evmAddress: EvmAddress;\n  stellarAddress: StellarAddress;\n  registeredAt: number; // ledger sequence\n}\n\n// ============================================================================\n// Transaction Types\n// ============================================================================\n\nexport interface EvmTransaction {\n  from: EvmAddress;\n  to?: EvmAddress; // undefined for contract deployment\n  value: bigint;\n  data: string;\n  nonce: number;\n  gasLimit: bigint;\n  gasPrice: bigint;\n  chainId: number;\n}\n\nexport interface EvmTransactionReceipt {\n  transactionHash: string;\n  transactionIndex: number;\n  blockHash: string;\n  blockNumber: number;\n  from: EvmAddress;\n  to: EvmAddress | null;\n  contractAddress: EvmAddress | null;\n  cumulativeGasUsed: bigint;\n  gasUsed: bigint;\n  status: 0 | 1;\n  logs: EvmLog[];\n}\n\nexport interface EvmLog {\n  address: EvmAddress;\n  topics: string[];\n  data: string;\n  blockNumber: number;\n  transactionHash: string;\n  transactionIndex: number;\n  blockHash: string;\n  logIndex: number;\n  removed: boolean;\n}\n\nexport interface EvmBlock {\n  number: number;\n  hash: string;\n  parentHash: string;\n  timestamp: number;\n  miner: EvmAddress;\n  difficulty: bigint;\n  totalDifficulty: bigint;\n  gasLimit: bigint;\n  gasUsed: bigint;\n  transactions: string[];\n  transactionsRoot: string;\n  stateRoot: string;\n  receiptsRoot: string;\n  logsBloom: string;\n  nonce: string;\n  extraData: string;\n}\n\n// ============================================================================\n// Compilation Types\n// ============================================================================\n\nexport interface CompilerInput {\n  /** Solidity source code */\n  source: string;\n  /** Contract file name */\n  fileName: string;\n  /** Compiler optimization settings */\n  optimization?: {\n    enabled: boolean;\n    runs?: number;\n  };\n}\n\nexport interface CompilerOutput {\n  /** Compiled WASM binary (base64 encoded) */\n  wasm: string;\n  /** Contract ABI in JSON format */\n  abi: ContractABI;\n  /** Soroban contract spec entries */\n  spec: SorobanSpec[];\n  /** Compilation warnings */\n  warnings: string[];\n  /** Source map for debugging */\n  sourceMap?: string;\n}\n\nexport interface ContractABI {\n  /** Contract name */\n  name: string;\n  /** ABI entries */\n  functions: ABIFunction[];\n  events: ABIEvent[];\n  errors: ABIError[];\n}\n\nexport interface ABIFunction {\n  name: string;\n  inputs: ABIParameter[];\n  outputs: ABIParameter[];\n  stateMutability: 'pure' | 'view' | 'nonpayable' | 'payable';\n  type: 'function' | 'constructor' | 'fallback' | 'receive';\n}\n\nexport interface ABIEvent {\n  name: string;\n  inputs: ABIEventParameter[];\n  anonymous: boolean;\n}\n\nexport interface ABIParameter {\n  name: string;\n  type: string;\n  internalType?: string;\n  components?: ABIParameter[];\n}\n\nexport interface ABIEventParameter extends ABIParameter {\n  indexed: boolean;\n}\n\nexport interface ABIError {\n  name: string;\n  inputs: ABIParameter[];\n}\n\nexport interface SorobanSpec {\n  type: 'function' | 'struct' | 'union' | 'enum' | 'error';\n  name: string;\n  doc?: string;\n  inputs?: { name: string; type: ScValType }[];\n  outputs?: ScValType[];\n}\n\n// ============================================================================\n// Soroban-Specific Types\n// ============================================================================\n\nexport type ScValType =\n  | 'bool'\n  | 'void'\n  | 'error'\n  | 'u32'\n  | 'i32'\n  | 'u64'\n  | 'i64'\n  | 'timepoint'\n  | 'duration'\n  | 'u128'\n  | 'i128'\n  | 'u256'\n  | 'i256'\n  | 'bytes'\n  | 'string'\n  | 'symbol'\n  | 'address'\n  | { vec: ScValType }\n  | { map: { key: ScValType; value: ScValType } }\n  | { option: ScValType }\n  | { result: { ok: ScValType; err: ScValType } }\n  | { tuple: ScValType[] }\n  | { bytesN: number }\n  | { struct: string }\n  | { union: string }\n  | { enum: string };\n\nexport type StorageType = 'temporary' | 'instance' | 'persistent';\n\nexport interface StorageEntry {\n  key: string;\n  value: unknown;\n  type: StorageType;\n  ttl: number; // ledger sequence when entry expires\n}\n\n// ============================================================================\n// Contract Interaction Types\n// ============================================================================\n\nexport interface DeploymentConfig {\n  /** Compiled WASM binary (base64) */\n  wasm: string;\n  /** Constructor arguments */\n  constructorArgs?: unknown[];\n  /** Initial salt for address derivation */\n  salt?: string;\n  /** Network to deploy to */\n  network: NetworkType;\n}\n\nexport interface DeploymentResult {\n  /** Soroban contract ID */\n  contractId: SorobanContractId;\n  /** EVM-compatible contract address */\n  evmAddress: EvmAddress;\n  /** Deployment transaction hash (Stellar format) */\n  stellarTxHash: string;\n  /** Deployment transaction hash (EVM format) */\n  evmTxHash: string;\n  /** Ledger sequence of deployment */\n  ledgerSequence: number;\n}\n\nexport interface ContractCallConfig {\n  /** Contract address (EVM or Soroban format) */\n  contractAddress: Address;\n  /** Function name to call */\n  functionName: string;\n  /** Function arguments */\n  args?: unknown[];\n  /** Caller address */\n  from?: Address;\n}\n\nexport interface ContractCallResult<T = unknown> {\n  /** Return value from the contract */\n  result: T;\n  /** Gas/resource consumption */\n  gasUsed: bigint;\n  /** Events emitted during call */\n  events: EvmLog[];\n  /** Whether the call was a simulation (view) or on-chain */\n  simulated: boolean;\n}\n\n// ============================================================================\n// Wallet Types\n// ============================================================================\n\nexport interface KeyPair {\n  /** secp256k1 private key for EVM signing */\n  evmPrivateKey: string;\n  /** secp256k1 public key (uncompressed, 65 bytes) */\n  evmPublicKey: string;\n  /** Ed25519 secret key for Stellar signing */\n  stellarSecretKey: string;\n  /** Ed25519 public key for Stellar */\n  stellarPublicKey: string;\n}\n\nexport interface Account {\n  /** EVM-format address */\n  evmAddress: EvmAddress;\n  /** Stellar G-address */\n  stellarAddress: StellarAddress;\n  /** Whether this account is registered in the AccountRegistry */\n  isRegistered: boolean;\n  /** Account sequence number (Stellar) */\n  sequenceNumber?: string;\n  /** Account nonce (EVM) */\n  nonce?: number;\n}\n\nexport interface Balance {\n  /** Native XLM balance (in stroops, 1 XLM = 10^7 stroops) */\n  xlm: bigint;\n  /** Native XLM balance formatted (7 decimals) */\n  xlmFormatted: string;\n  /** Token balances keyed by contract address */\n  tokens: Map<Address, TokenBalance>;\n}\n\nexport interface TokenBalance {\n  /** Token contract address */\n  address: Address;\n  /** Token symbol */\n  symbol: string;\n  /** Token decimals */\n  decimals: number;\n  /** Raw balance */\n  balance: bigint;\n  /** Formatted balance */\n  balanceFormatted: string;\n}\n\n// ============================================================================\n// Error Types\n// ============================================================================\n\nexport class TVAError extends Error {\n  constructor(\n    message: string,\n    public code: TVAErrorCode,\n    public details?: Record<string, unknown>\n  ) {\n    super(message);\n    this.name = 'TVAError';\n  }\n}\n\nexport enum TVAErrorCode {\n  // Compilation errors (1xxx)\n  COMPILATION_FAILED = 1001,\n  SOLANG_NOT_FOUND = 1002,\n  INVALID_SOURCE = 1003,\n\n  // Network errors (2xxx)\n  NETWORK_ERROR = 2001,\n  RPC_ERROR = 2002,\n  TIMEOUT = 2003,\n\n  // Transaction errors (3xxx)\n  TRANSACTION_FAILED = 3001,\n  INSUFFICIENT_BALANCE = 3002,\n  INVALID_NONCE = 3003,\n  GAS_ESTIMATION_FAILED = 3004,\n\n  // Contract errors (4xxx)\n  CONTRACT_NOT_FOUND = 4001,\n  CONTRACT_REVERT = 4002,\n  INVALID_ARGUMENTS = 4003,\n\n  // Account errors (5xxx)\n  ACCOUNT_NOT_FOUND = 5001,\n  ACCOUNT_NOT_REGISTERED = 5002,\n  INVALID_SIGNATURE = 5003,\n\n  // Storage errors (6xxx)\n  STATE_ARCHIVED = 6001,\n  TTL_EXPIRED = 6002,\n  RESTORATION_FAILED = 6003,\n}\n","/**\n * TVA Protocol Contract Interaction\n *\n * Provides high-level APIs for deploying and interacting with\n * Solidity contracts compiled to Soroban WASM.\n */\n\nimport {\n  Contract,\n  TransactionBuilder,\n  Operation,\n  xdr,\n  Address,\n  nativeToScVal,\n  scValToNative,\n  rpc,\n} from '@stellar/stellar-sdk';\nimport type {\n  ContractABI,\n  ABIFunction,\n  EvmAddress,\n  SorobanContractId,\n  NetworkType,\n  NetworkConfig,\n  DeploymentResult,\n  ContractCallResult,\n  EvmLog,\n} from '../types/index.js';\nimport { NETWORKS, TVAError, TVAErrorCode } from '../types/index.js';\nimport type { TVASigner } from '../wallet/signer.js';\nimport type { CompiledContract } from '../compiler/solang.js';\nimport { keccak_256 } from '@noble/hashes/sha3';\n\n/**\n * Converts an EVM address to a Soroban contract ID format\n * This is deterministic based on the deployment parameters\n */\nexport function evmAddressToContractId(evmAddress: EvmAddress): SorobanContractId {\n  // The contract ID is derived from the deployment transaction\n  // For now, return a placeholder - real implementation needs AccountRegistry lookup\n  const addressBytes = Buffer.from(evmAddress.slice(2), 'hex');\n  // Pad to 32 bytes and encode as Soroban C-address\n  const padded = Buffer.alloc(32);\n  addressBytes.copy(padded, 12);\n\n  // This is a simplified version - real implementation uses Stellar's address encoding\n  const encoded = padded.toString('hex');\n  return `C${encoded.toUpperCase().slice(0, 55)}` as SorobanContractId;\n}\n\n/**\n * Converts a Soroban contract ID to an EVM address format\n */\nexport function contractIdToEvmAddress(contractId: SorobanContractId): EvmAddress {\n  // Extract bytes from contract ID and take last 20 bytes\n  // Real implementation needs proper C-address decoding\n  const hex = contractId.slice(1).toLowerCase();\n  const last40 = hex.slice(-40);\n  return `0x${last40}` as EvmAddress;\n}\n\n/**\n * Calculates the EVM function selector (first 4 bytes of keccak256 hash)\n */\nexport function getFunctionSelector(signature: string): string {\n  const hash = keccak_256(new TextEncoder().encode(signature));\n  return '0x' + Buffer.from(hash.slice(0, 4)).toString('hex');\n}\n\n/**\n * Gets the function signature from ABI\n */\nexport function getFunctionSignature(func: ABIFunction): string {\n  const inputTypes = func.inputs.map((i) => i.type).join(',');\n  return `${func.name}(${inputTypes})`;\n}\n\n/**\n * Encodes function call data in EVM ABI format\n */\nexport function encodeFunctionCall(\n  func: ABIFunction,\n  args: unknown[]\n): string {\n  const signature = getFunctionSignature(func);\n  const selector = getFunctionSelector(signature);\n\n  // Encode arguments (simplified - use ethers.js AbiCoder for full support)\n  const encodedArgs = encodeArguments(func.inputs, args);\n\n  return selector + encodedArgs.slice(2);\n}\n\n/**\n * Encodes arguments for ABI\n */\nfunction encodeArguments(\n  inputs: { name: string; type: string }[],\n  args: unknown[]\n): string {\n  const parts: string[] = [];\n\n  for (let i = 0; i < inputs.length; i++) {\n    const input = inputs[i];\n    const arg = args[i];\n    parts.push(encodeValue(input.type, arg));\n  }\n\n  return '0x' + parts.join('');\n}\n\n/**\n * Encodes a single value for ABI\n */\nfunction encodeValue(type: string, value: unknown): string {\n  // Handle basic types\n  if (type === 'address') {\n    const addr = (value as string).replace(/^0x/, '').toLowerCase();\n    return addr.padStart(64, '0');\n  }\n\n  if (type.startsWith('uint') || type.startsWith('int')) {\n    const num = BigInt(value as string | number | bigint);\n    const hex = num.toString(16);\n    return hex.padStart(64, '0');\n  }\n\n  if (type === 'bool') {\n    return (value ? '1' : '0').padStart(64, '0');\n  }\n\n  if (type === 'bytes32') {\n    const bytes = (value as string).replace(/^0x/, '');\n    return bytes.padEnd(64, '0');\n  }\n\n  if (type === 'string') {\n    const strBytes = new TextEncoder().encode(value as string);\n    const length = strBytes.length.toString(16).padStart(64, '0');\n    const data = Buffer.from(strBytes).toString('hex').padEnd(\n      Math.ceil(strBytes.length / 32) * 64,\n      '0'\n    );\n    // For dynamic types, we need offset + length + data\n    // Simplified: just encode inline for now\n    return length + data;\n  }\n\n  throw new Error(`Unsupported ABI type: ${type}`);\n}\n\n/**\n * Converts Solidity type to ScVal type\n */\nfunction solidityTypeToScVal(type: string, value: unknown): xdr.ScVal {\n  if (type === 'address') {\n    const addrStr = value as string;\n    // If it's a Stellar address (starts with G), use it directly\n    // Otherwise, convert from EVM address\n    if (addrStr.startsWith('G')) {\n      return Address.fromString(addrStr).toScVal();\n    }\n    // For EVM addresses, we'd need to look up the registry\n    // For now, create a bytes representation\n    return xdr.ScVal.scvBytes(Buffer.from(addrStr.replace(/^0x/, ''), 'hex'));\n  }\n\n  if (type === 'uint64' || type === 'uint') {\n    return nativeToScVal(BigInt(value as string | number), { type: 'u64' });\n  }\n\n  if (type === 'int64') {\n    return nativeToScVal(BigInt(value as string | number), { type: 'i64' });\n  }\n\n  if (type === 'uint128') {\n    return nativeToScVal(BigInt(value as string | number), { type: 'u128' });\n  }\n\n  if (type === 'int128') {\n    return nativeToScVal(BigInt(value as string | number), { type: 'i128' });\n  }\n\n  if (type === 'uint32') {\n    return nativeToScVal(Number(value), { type: 'u32' });\n  }\n\n  if (type === 'int32') {\n    return nativeToScVal(Number(value), { type: 'i32' });\n  }\n\n  if (type === 'bool') {\n    return nativeToScVal(Boolean(value), { type: 'bool' });\n  }\n\n  if (type === 'string') {\n    return nativeToScVal(String(value), { type: 'string' });\n  }\n\n  if (type === 'bytes' || type.startsWith('bytes')) {\n    const bytes = Buffer.from((value as string).replace(/^0x/, ''), 'hex');\n    return xdr.ScVal.scvBytes(bytes);\n  }\n\n  // Default to string conversion\n  return nativeToScVal(String(value), { type: 'string' });\n}\n\n/**\n * TVA Contract instance for interacting with deployed contracts\n */\nexport class TVAContract {\n  public readonly contractId: SorobanContractId;\n  public readonly evmAddress: EvmAddress;\n  public readonly abi: ContractABI;\n  private readonly network: NetworkConfig;\n  private readonly sorobanClient: rpc.Server;\n\n  constructor(\n    contractId: SorobanContractId,\n    abi: ContractABI,\n    network: NetworkType = 'testnet'\n  ) {\n    this.contractId = contractId;\n    this.evmAddress = contractIdToEvmAddress(contractId);\n    this.abi = abi;\n    this.network = NETWORKS[network];\n    this.sorobanClient = new rpc.Server(this.network.sorobanRpcUrl);\n  }\n\n  /**\n   * Gets a function from the ABI by name\n   */\n  getFunction(name: string): ABIFunction | undefined {\n    return this.abi.functions.find((f) => f.name === name);\n  }\n\n  /**\n   * Simulates a contract call (read-only, doesn't submit transaction)\n   */\n  async call<T = unknown>(\n    functionName: string,\n    args: unknown[] = [],\n    signer?: TVASigner\n  ): Promise<ContractCallResult<T>> {\n    const func = this.getFunction(functionName);\n    if (!func) {\n      throw new TVAError(\n        `Function ${functionName} not found in contract ABI`,\n        TVAErrorCode.INVALID_ARGUMENTS,\n        { availableFunctions: this.abi.functions.map((f) => f.name) }\n      );\n    }\n\n    // Convert arguments to ScVal format\n    const scArgs = func.inputs.map((input, i) =>\n      solidityTypeToScVal(input.type, args[i])\n    );\n\n    // Build the contract call\n    const contract = new Contract(this.contractId);\n    const operation = contract.call(functionName, ...scArgs);\n\n    // If no signer, we need a source account for simulation\n    // Use a placeholder public key - simulation doesn't require real signature\n    const sourcePublicKey = signer?.stellarAddress ||\n      'GAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWHF';\n\n    // Get account info\n    let account;\n    try {\n      account = await this.sorobanClient.getAccount(sourcePublicKey);\n    } catch {\n      // For simulation, we can use a mock account\n      account = {\n        accountId: () => sourcePublicKey,\n        sequenceNumber: () => '0',\n        incrementSequenceNumber: () => {},\n      };\n    }\n\n    // Build transaction\n    const transaction = new TransactionBuilder(account as any, {\n      fee: '100',\n      networkPassphrase: this.network.networkPassphrase,\n    })\n      .addOperation(operation)\n      .setTimeout(30)\n      .build();\n\n    // Simulate the transaction\n    const simulation = await this.sorobanClient.simulateTransaction(transaction);\n\n    if (rpc.Api.isSimulationError(simulation)) {\n      throw new TVAError(\n        `Contract call simulation failed: ${simulation.error}`,\n        TVAErrorCode.CONTRACT_REVERT,\n        { error: simulation.error }\n      );\n    }\n\n    // Extract result\n    let result: T = undefined as T;\n    if (rpc.Api.isSimulationSuccess(simulation) && simulation.result) {\n      result = scValToNative(simulation.result.retval) as T;\n    }\n\n    // Extract events/logs\n    const events: EvmLog[] = [];\n    // Events would be extracted from simulation.events when available\n\n    return {\n      result,\n      gasUsed: BigInt(simulation.minResourceFee || 0),\n      events,\n      simulated: true,\n    };\n  }\n\n  /**\n   * Sends a transaction to the contract (state-changing)\n   */\n  async send(\n    functionName: string,\n    args: unknown[] = [],\n    signer: TVASigner\n  ): Promise<ContractCallResult<unknown>> {\n    const func = this.getFunction(functionName);\n    if (!func) {\n      throw new TVAError(\n        `Function ${functionName} not found in contract ABI`,\n        TVAErrorCode.INVALID_ARGUMENTS,\n        { availableFunctions: this.abi.functions.map((f) => f.name) }\n      );\n    }\n\n    // Convert arguments to ScVal format\n    const scArgs = func.inputs.map((input, i) =>\n      solidityTypeToScVal(input.type, args[i])\n    );\n\n    // Build the contract call\n    const contract = new Contract(this.contractId);\n    const operation = contract.call(functionName, ...scArgs);\n\n    // Get account\n    const account = await this.sorobanClient.getAccount(signer.stellarAddress);\n\n    // Build transaction\n    let transaction = new TransactionBuilder(account, {\n      fee: '100',\n      networkPassphrase: this.network.networkPassphrase,\n    })\n      .addOperation(operation)\n      .setTimeout(30)\n      .build();\n\n    // Simulate to get resource requirements\n    const simulation = await this.sorobanClient.simulateTransaction(transaction);\n\n    if (rpc.Api.isSimulationError(simulation)) {\n      throw new TVAError(\n        `Transaction simulation failed: ${simulation.error}`,\n        TVAErrorCode.CONTRACT_REVERT,\n        { error: simulation.error }\n      );\n    }\n\n    // Prepare transaction with simulation results\n    transaction = rpc.assembleTransaction(\n      transaction,\n      simulation\n    ).build();\n\n    // Sign with Stellar key\n    const signedTx = signer.signStellarTransaction(transaction);\n\n    // Submit transaction\n    const sendResponse = await this.sorobanClient.sendTransaction(signedTx);\n\n    if (sendResponse.status === 'ERROR') {\n      throw new TVAError(\n        `Transaction submission failed`,\n        TVAErrorCode.TRANSACTION_FAILED,\n        { response: sendResponse }\n      );\n    }\n\n    // Wait for confirmation\n    let txResult = await this.sorobanClient.getTransaction(sendResponse.hash);\n    while (txResult.status === 'NOT_FOUND') {\n      await new Promise((resolve) => setTimeout(resolve, 1000));\n      txResult = await this.sorobanClient.getTransaction(sendResponse.hash);\n    }\n\n    if (txResult.status !== 'SUCCESS') {\n      throw new TVAError(\n        `Transaction failed: ${txResult.status}`,\n        TVAErrorCode.TRANSACTION_FAILED,\n        { result: txResult }\n      );\n    }\n\n    // Extract return value\n    let returnValue: unknown = undefined;\n    if ('returnValue' in txResult && txResult.returnValue) {\n      returnValue = scValToNative(txResult.returnValue as xdr.ScVal);\n    }\n\n    return {\n      result: returnValue,\n      gasUsed: BigInt(0), // Fee info not directly available in GetTransactionResponse\n      events: [], // TODO: Parse events from result\n      simulated: false,\n    };\n  }\n\n  /**\n   * Creates a typed contract interface with methods matching the ABI\n   */\n  connect(signer: TVASigner): TypedContract {\n    return new TypedContract(this, signer);\n  }\n}\n\n/**\n * Typed contract wrapper that provides method-based access\n */\nexport class TypedContract {\n  private contract: TVAContract;\n  private signer: TVASigner;\n\n  constructor(contract: TVAContract, signer: TVASigner) {\n    this.contract = contract;\n    this.signer = signer;\n\n    // Create dynamic methods for each function in the ABI\n    for (const func of contract.abi.functions) {\n      if (func.type === 'constructor') continue;\n\n      const isView =\n        func.stateMutability === 'view' || func.stateMutability === 'pure';\n\n      (this as any)[func.name] = async (...args: unknown[]) => {\n        if (isView) {\n          return this.contract.call(func.name, args, this.signer);\n        } else {\n          return this.contract.send(func.name, args, this.signer);\n        }\n      };\n    }\n  }\n\n  /**\n   * Gets the underlying contract instance\n   */\n  getContract(): TVAContract {\n    return this.contract;\n  }\n}\n\n/**\n * Contract deployer for deploying new contracts\n */\nexport class ContractDeployer {\n  private network: NetworkConfig;\n  private sorobanClient: rpc.Server;\n\n  constructor(network: NetworkType = 'testnet') {\n    this.network = NETWORKS[network];\n    this.sorobanClient = new rpc.Server(this.network.sorobanRpcUrl);\n  }\n\n  /**\n   * Deploys a compiled contract to the network\n   */\n  async deploy(\n    contract: CompiledContract,\n    signer: TVASigner,\n    constructorArgs: unknown[] = []\n  ): Promise<DeploymentResult> {\n    // Step 1: Upload the WASM\n    const wasmHash = await this.uploadWasm(contract.wasm, signer);\n\n    // Step 2: Create the contract instance\n    const contractId = await this.createInstance(\n      wasmHash,\n      signer,\n      contract.abi,\n      constructorArgs\n    );\n\n    // Calculate EVM address from contract ID\n    const evmAddress = contractIdToEvmAddress(contractId);\n\n    // Get deployment transaction info\n    const ledgerSequence = await this.getCurrentLedgerSequence();\n\n    return {\n      contractId,\n      evmAddress,\n      stellarTxHash: wasmHash, // Using wasm hash as placeholder\n      evmTxHash: `0x${wasmHash.slice(0, 64)}`,\n      ledgerSequence,\n    };\n  }\n\n  /**\n   * Uploads WASM to the network\n   */\n  private async uploadWasm(wasm: Buffer, signer: TVASigner): Promise<string> {\n    // Get account\n    const account = await this.sorobanClient.getAccount(signer.stellarAddress);\n\n    // Build upload transaction\n    const uploadOp = Operation.uploadContractWasm({ wasm });\n\n    let transaction = new TransactionBuilder(account, {\n      fee: '100',\n      networkPassphrase: this.network.networkPassphrase,\n    })\n      .addOperation(uploadOp)\n      .setTimeout(30)\n      .build();\n\n    // Simulate\n    const simulation = await this.sorobanClient.simulateTransaction(transaction);\n\n    if (rpc.Api.isSimulationError(simulation)) {\n      throw new TVAError(\n        `WASM upload simulation failed: ${simulation.error}`,\n        TVAErrorCode.COMPILATION_FAILED,\n        { error: simulation.error }\n      );\n    }\n\n    // Prepare and sign\n    transaction = rpc.assembleTransaction(transaction, simulation).build();\n    const signedTx = signer.signStellarTransaction(transaction);\n\n    // Submit\n    const response = await this.sorobanClient.sendTransaction(signedTx);\n\n    // Wait for confirmation\n    let result: any = response;\n    while (result.status === 'PENDING' || result.status === 'NOT_FOUND') {\n      await new Promise((resolve) => setTimeout(resolve, 1000));\n      result = await this.sorobanClient.getTransaction(response.hash);\n    }\n\n    if (result.status !== 'SUCCESS') {\n      throw new TVAError(\n        `WASM upload failed: ${result.status}`,\n        TVAErrorCode.COMPILATION_FAILED,\n        { result }\n      );\n    }\n\n    // Extract WASM hash from result\n    // The hash is returned in the transaction result\n    const wasmHash = keccak_256(wasm);\n    return Buffer.from(wasmHash).toString('hex');\n  }\n\n  /**\n   * Creates a contract instance from uploaded WASM\n   */\n  private async createInstance(\n    wasmHash: string,\n    signer: TVASigner,\n    _abi: ContractABI,\n    _constructorArgs: unknown[]\n  ): Promise<SorobanContractId> {\n    // Get account\n    const account = await this.sorobanClient.getAccount(signer.stellarAddress);\n\n    // Build create contract operation\n    const createOp = Operation.createCustomContract({\n      address: Address.fromString(signer.stellarAddress),\n      wasmHash: Buffer.from(wasmHash, 'hex'),\n      salt: Buffer.from(keccak_256(new TextEncoder().encode(Date.now().toString()))),\n    });\n\n    let transaction = new TransactionBuilder(account, {\n      fee: '100',\n      networkPassphrase: this.network.networkPassphrase,\n    })\n      .addOperation(createOp)\n      .setTimeout(30)\n      .build();\n\n    // Simulate\n    const simulation = await this.sorobanClient.simulateTransaction(transaction);\n\n    if (rpc.Api.isSimulationError(simulation)) {\n      throw new TVAError(\n        `Contract creation simulation failed: ${simulation.error}`,\n        TVAErrorCode.COMPILATION_FAILED,\n        { error: simulation.error }\n      );\n    }\n\n    // Prepare and sign\n    transaction = rpc.assembleTransaction(transaction, simulation).build();\n    const signedTx = signer.signStellarTransaction(transaction);\n\n    // Submit\n    const response = await this.sorobanClient.sendTransaction(signedTx);\n\n    // Wait for confirmation\n    let result: any = response;\n    while (result.status === 'PENDING' || result.status === 'NOT_FOUND') {\n      await new Promise((resolve) => setTimeout(resolve, 1000));\n      result = await this.sorobanClient.getTransaction(response.hash);\n    }\n\n    if (result.status !== 'SUCCESS') {\n      throw new TVAError(\n        `Contract creation failed: ${result.status}`,\n        TVAErrorCode.COMPILATION_FAILED,\n        { result }\n      );\n    }\n\n    // Extract contract ID from result\n    // The contract ID is derived from the creator address and salt\n    const contractIdBytes = keccak_256(\n      new Uint8Array([\n        ...new TextEncoder().encode(signer.stellarAddress),\n        ...Buffer.from(wasmHash, 'hex'),\n      ])\n    );\n\n    return `C${Buffer.from(contractIdBytes).toString('hex').toUpperCase().slice(0, 55)}` as SorobanContractId;\n  }\n\n  /**\n   * Gets the current ledger sequence number\n   */\n  private async getCurrentLedgerSequence(): Promise<number> {\n    const latestLedger = await this.sorobanClient.getLatestLedger();\n    return latestLedger.sequence;\n  }\n}\n"]}